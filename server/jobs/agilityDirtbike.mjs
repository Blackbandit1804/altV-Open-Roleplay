import * as alt from 'alt';
import {
    Job,
    Objective,
    copyObjective,
    objectives,
    modifiers,
    restrictions
} from '../systems/job.mjs';
import { Interaction } from '../systems/interaction.mjs';

const jobName = 'Agility Training';
const trackStart = { x: -1186.2593994140625, y: 3856.404296875, z: 489.987548828125 };
const trackPoints = [
{  x: -1186.2593994140625, y: 3856.404296875, z: 489.987548828125 }, 
{ x: -1171.4110107421875, y: 3846.936279296875, z: 487.308349609375 }, 
{ x: -1155.217529296875, y: 3837.83740234375, z: 482.034423828125 }, 
{ x: -1136.4659423828125, y: 3838.786865234375, z: 473.491455078125 }, 
{ x: -1115.5780029296875, y: 3837.65283203125, z: 463.68505859375 }, 
{ x: -1099.5823974609375, y: 3834.43505859375, z: 455.79931640625 }, 
{ x: -1075.6351318359375, y: 3828.883544921875, z: 446.06005859375 }, 
{ x: -1055.77587890625, y: 3829.107666015625, z: 443.549560546875 }, 
{ x: -1044.3033447265625, y: 3830.1494140625, z: 440.802978515625 }, 
{ x: -1026.19775390625, y: 3830.0439453125, z: 435.5458984375 }, 
{ x: -1010.1626586914062, y: 3829.912109375, z: 430.271728515625 }, 
{ x: -988.5230712890625, y: 3828.738525390625, z: 427.9296875 }, 
{ x: -974.953857421875, y: 3821.59130859375, z: 430.35595703125 }, 
{ x: -962.6109619140625, y: 3806.861572265625, z: 427.474609375 }, 
{ x: -961.3978271484375, y: 3789.481201171875, z: 417.213134765625 }, 
{ x: -961.3186645507812, y: 3773.142822265625, z: 411.85498046875 }, 
{ x: -963.7977905273438, y: 3760.23291015625, z: 407.271728515625 }, 
{ x: -969.5999755859375, y: 3747.9033203125, z: 402.857177734375 }, 
{ x: -974.4527587890625, y: 3737.77587890625, z: 399.841064453125 }, 
{ x: -976.2725219726562, y: 3727.437255859375, z: 397.380859375 }, 
{ x: -978.8175659179688, y: 3715.358154296875, z: 395.173583984375 }, 
{ x: -979.054931640625, y: 3697.912109375, z: 390.337646484375 }, 
{ x: -970.931884765625, y: 3677.6044921875, z: 379.08203125 }, 
{ x: -965.6307983398438, y: 3669.362548828125, z: 374.93701171875 }, 
{ x: -956.3604125976562, y: 3657.7978515625, z: 367.826416015625 }, 
{ x: -949.7670288085938, y: 3647.419677734375, z: 360.412353515625 }, 
{ x: -945.112060546875, y: 3636.2900390625, z: 353.20068359375 }, 
{ x: -942.6461791992188, y: 3616.852783203125, z: 341.4395751953125 }, 
{ x: -940.2857055664062, y: 3606.01318359375, z: 333.3348388671875 }, 
{ x: -937.7933959960938, y: 3589.081298828125, z: 321.15234375 }, 
{ x: -935.90771484375, y: 3576.3427734375, z: 311.750244140625 }, 
{ x: -934.4439697265625, y: 3563.103271484375, z: 302.7354736328125 }, 
{ x: -933.1648559570312, y: 3547.60888671875, z: 297.899658203125 }, 
{ x: -932.3340454101562, y: 3534.17138671875, z: 293.788330078125 }, 
{ x: -931.5428466796875, y: 3522.32958984375, z: 288.3458251953125 }, 
{ x: -931.054931640625, y: 3509.037353515625, z: 283.4088134765625 }, 
{ x: -932.6505737304688, y: 3491.77587890625, z: 276.5172119140625 }, 
{ x: -933.876953125, y: 3473.841796875, z: 269.2886962890625 }, 
{ x: -934.1670532226562, y: 3451.397705078125, z: 261.06591796875 }, 
{ x: -934.3648071289062, y: 3431.56494140625, z: 252.6072998046875 }, 
{ x: -937.028564453125, y: 3419.5517578125, z: 248.6307373046875 }, 
{ x: -941.3538208007812, y: 3407.366943359375, z: 246.103271484375 }, 
{ x: -943.3978271484375, y: 3391.015380859375, z: 241.7222900390625 }, 
{ x: -941.3274536132812, y: 3373.9912109375, z: 231.4608154296875 }, 
{ x: -937.5428466796875, y: 3360.817626953125, z: 221.6710205078125 }, 
{ x: -935.8681030273438, y: 3349.701171875, z: 216.4813232421875 }, 
{ x: -934.04833984375, y: 3337.160400390625, z: 214.07177734375 }, 
{ x: -931.89892578125, y: 3327.67919921875, z: 212.066650390625 }, 
{ x: -928.2461547851562, y: 3320.0966796875, z: 209.3538818359375 }, 
{ x: -918.1714477539062, y: 3308.29443359375, z: 203.3721923828125 }, 
{ x: -908.0703125, y: 3301.912109375, z: 199.4124755859375 }, 
{ x: -896.5318603515625, y: 3293.74951171875, z: 194.3575439453125 }, 
{ x: -889.5823974609375, y: 3289.410888671875, z: 191.0380859375 }, 
{ x: -879.2044067382812, y: 3284.29443359375, z: 185.747314453125 }, 
{ x: -871.015380859375, y: 3279.283447265625, z: 180.92822265625 }, 
{ x: -864.909912109375, y: 3275.406494140625, z: 177.1201171875 }, 
{ x: -856.5889892578125, y: 3269.80224609375, z: 171.947265625 }, 
{ x: -849.6659545898438, y: 3264.778076171875, z: 168.223388671875 }, 
{ x: -837.94287109375, y: 3256.12744140625, z: 162.2755126953125 }, 
{ x: -830.1890258789062, y: 3250.03515625, z: 159.0234375 }, 
{ x: -823.2000122070312, y: 3243.54736328125, z: 157.4564208984375 }, 
{ x: -817.7933959960938, y: 3238.4306640625, z: 156.7318115234375 }, 
{ x: -807.91650390625, y: 3229.028564453125, z: 154.238037109375 }, 
{ x: -800.967041015625, y: 3222.369140625, z: 149.7222900390625 }, 
{ x: -796.1802368164062, y: 3216.03955078125, z: 145.3919677734375 }, 
{ x: -790.4967041015625, y: 3205.186767578125, z: 138.3319091796875 }, 
{ x: -786.5538330078125, y: 3196.298828125, z: 133.4285888671875 }, 
{ x: -779.037353515625, y: 3183.83740234375, z: 128.154541015625 }, 
{ x: -772.4439697265625, y: 3174.725341796875, z: 123.3524169921875 }, 
{ x: -765.1384887695312, y: 3167.366943359375, z: 120.134033203125 }, 
{ x: -752.6109619140625, y: 3154.707763671875, z: 113.6973876953125 }, 
{ x: -743.8153686523438, y: 3145.8330078125, z: 109.14794921875 }, 
{ x: -735.5076904296875, y: 3137.406494140625, z: 105.3231201171875 }, 
{ x: -728.3340454101562, y: 3127.292236328125, z: 101.06005859375 }, 
{ x: -723.8109741210938, y: 3114.712158203125, z: 95.904052734375 }, 
{ x: -724.1670532226562, y: 3108.263671875, z: 93.2923583984375 }, 
{ x: -725.5780029296875, y: 3103.84619140625, z: 91.6746826171875 }, 
{ x: -729.7318725585938, y: 3092.505615234375, z: 87.6812744140625 }, 
{ x: -732.3824462890625, y: 3085.371337890625, z: 85.3055419921875 }, 
{ x: -733.92529296875, y: 3078.09228515625, z: 82.6094970703125 }, 
{ x: -733.7538452148438, y: 3065.301025390625, z: 77.0322265625 }, 
{ x: -731.7230834960938, y: 3038.4921875, z: 64.6307373046875 }, 
{ x: -730.7736206054688, y: 3032.716552734375, z: 60.5194091796875 }, 
{ x: -728.7560424804688, y: 3022.945068359375, z: 51.6900634765625 }, 
{ x: -725.93408203125, y: 3010.39111328125, z: 43.5179443359375 }, 
{ x: -724.984619140625, y: 3005.80224609375, z: 41.93408203125 }, 
{ x: -717.7846069335938, y: 2955.7978515625, z: 25.4381103515625 }
];

let interactionPoint = { ...trackStart };
interactionPoint.z -= 0.5;
let interaction = new Interaction(
    interactionPoint,
    'job',
    'job:Dirtbike',
    3,
    3,
    'to begin training agility.'
);
interaction.addBlip(126, 6, jobName);

alt.on('job:Dirtbike', player => {
    let job = new Job(player, jobName, restrictions.NO_DIEING | restrictions.NO_WEAPONS);

    // Set First Objective
    const emptyVector = { x: 0, y: 0, z: 0 };
    let obj = new Objective(objectives.POINT, modifiers.ON_FOOT);
    obj.setPosition(trackStart);
    obj.setRange(3);
    obj.setHelpText('Pick up your dirtbike.');
    obj.setBlip(255, 1, trackStart);
    obj.setMarker(
        0,
        trackStart,
        emptyVector,
        emptyVector,
        new alt.Vector3(1, 1, 1),
        0,
        255,
        0,
        100
    );
    obj.setVehicle('manchez', trackStart);
    job.add(copyObjective(obj));

    // Setup the rest of the points.
    trackPoints.forEach(pos => {
        obj = new Objective(objectives.POINT, modifiers.IN_VEHICLE);
        obj.setHelpText('Follow the course down.');
        obj.setPosition(pos);
        obj.setBlip(1, 2, pos);
        obj.setMarker(
            0,
            pos,
            emptyVector,
            emptyVector,
            new alt.Vector3(1, 1, 1),
            0,
            255,
            0,
            100
        );
        obj.setFinishedSound('complete');
        obj.setRewards([{ type: 'xp', prop: 'agility', quantity: 1 }]);
        job.add(copyObjective(obj));
    });

    let pos = { x: -717.7846069335938, y: 2955.7978515625, z: 25.4381103515625 };
    obj = new Objective(objectives.POINT, modifiers.IN_VEHICLE);
    obj.setHelpText('Finish the course.');
    obj.setPosition(pos);
    obj.setBlip(1, 2, pos);
    obj.setMarker(
        0,
        pos,
        emptyVector,
        emptyVector,
        new alt.Vector3(1, 1, 1),
        0,
        255,
        0,
        100
    );
    obj.setFinishedSound('complete');
    obj.setRewards([{ type: 'xp', prop: 'agility', quantity: 10 }]);
    job.add(copyObjective(obj));

    job.start(player);
});
